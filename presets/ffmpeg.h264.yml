# default h264 options
# other presets can override these settings

# different profiles: low/high
# coder: low: 0, high: 1 (cabac)
# trellis: low: 0, high: 1/2
# refs: low: 1, high: 1-16
# flags2: high only

h264:
  
# AUDIO  
  acodec: 'libfaac'  
  ab: '128k'

# VIDEO
  vcodec: 'libx264'  
  f: 'mp4'      # format
  r: 15         # framerate

# ----------------
# RATE CONTROL: Variable

  # TARGET BITRATE
  # should always be used in 2-pass mode
  b: '1500k'    # bitrate

  # BITRATE TOLERANCE
  # allowed variable of average bitrate
  bt: '1500k'  

  # QUANTIZER SCALE (VBR only)
  qcomp: 0.6        # compression: 0 = good stills   1 = good motion   .6 = default
  qmin: 10          # good default
  qmax: 51          # good default
  qdiff: 4          # max diff between quantizer scales
    

# -----------
# COMPRESSION (frame-type options)

  # Entropy coder
  # 0: CAVLC
  # 1: CABAC
  # CABAC not allowed in baseline (must use 0)
  # 10-15% better compression (but slower)
  coder: 1

  # Enable/disable loop filter
  # rec: +loop
  flags: '+loop'  

  # ?
  cmp: 'chroma'  

  # G: gop length (== keyframe interval == keyint)
  # max distance between i-frames
  # rec default: 250
  # note: in flash, can only scrub to keyframes
  g: 45

  # KEYINT (keyframes interval)
  # rec default: 25
  keyint_min: 15

  # Scenecut detection
  # default 40: doesn't need to be changed
  sc_threshold: 40  

  # REFERENCE FRAMES (H.264)
  # reference frames other than the one immediately prior
  # good default: 6   max value: 16
  # change for different profiles (1 = need for low complex profile)
  refs: 3

  # Max B-frames (MPEG 1/2/4 only)
  # Not supported by Baseline Profile (ipods)
  # 16 is best; encoder will choose how many _up to_ 16 to use
  # if encoding for hardware, check specs
  bf: 3

  # H.264 bframe lookahead mode selector (0, 1, 2)
  # default: 1
  b_strategy: 1

# ----------------
# RATE CONTROL: Always

  # RATE CONTROL EQUATION
  # http://ffmpeg.mplayerhq.hu/ffmpeg-doc.html#SEC17
  rc_eq: 'blurCplx^(1-qComp)'
  i_qfactor: 0.71   # qp factor between P- and I-frames (i_frame_qp/p_frame_qp)

# ------------------
# ANALYSIS

  # PARTITIONS
  # inter/intra partitions to analyze
  # i8x8 only allowed in High Profile mode
  partitions: '+parti4x4+partp8x8+partb8x8'

  # TRELLIS: trellis RD quantization
  # 0 = disabled   1 = higher qual   slower   2 = max qual   very slow
  # requires CABAC
  trellis: 1  

  # FLAGS2
  # dct8x8: allows choosing betwee 8x8 and 4x4.  High Profile only
  flags2: '+wpred+dct8x8+mixed_refs'  

  # *ME (motion estimation)
  # dia = low, hex = normal, umh = high (40% slower)
  # 
  me_method: 'umh'  
  me_range: 16

  # *SUBQ: time v. quality
  # 5 = normal   6 = high   7 = best (35% slower)
  subq: 6